<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>I've got NaNtyNaN problems, but 'this' !== 1</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h1>NaNtyNaN problems,<br>but 'this' !== 1</h1>
          <h3><a>An introduction to JavaScript</a></h3>
          <p>
            <small><a href="http://twitter.com/seutje">@seutje</a></small>
          </p>
        </section>

        <section>
          <h2>Mandatory introduction slide</h2>
          <ul class="bare">
              <li>Steve De Jonghe</li>
              <li>Intertubes plumber @ <a href="http://wunderkraut.com">Wunderkraut</a> <a href="http://wunderkraut.be">Belgium</a> (Antwerp office)</li>
              <li><a href="http://lmgtfy.com/?q=seutje">seutje</a></li>
              <li>many supports: IRC #jQuery</li>
              <li>Drupal Core 7 &amp; 8</li>
              <li>JavaScript component<br><a href="http://drupal.org/user/598310">Th√©odore Biadala</a> &amp; <a href="http://drupal.org/user/748566">Jesse Beach</a></li>
          </ul>

          <aside class="notes">
            Point out minimal core involvement.
          </aside>
        </section>

        <section>
          <h2>Preface</h2>
          <h3>Tooling</h3>
          <ul>
            <li>The browser is your #1 tool for writing JavaScript:
              <ul>
                <li>Fully fledged IDE with all the debugging tools you could possible want</li>
                <li>Allows conditional breakpoint</li>
                <li>Allows breaking on things non-code (subtree modification, etc)</li>
                <li>Allows swapping remote files with locals ones at-runtime</li>
                <li>Allows beautifying production code</li>
                <li><a href="https://getfirebug.com/wiki/index.php/Console_API" target="_blank">Console API</a></li>
                <li>much, much more! (checkout "the breakpoint" on youtube or every talk by Paul Irish, ever)</li>
              </ul>
            </li>
          </ul>
        </section>

        <section>
          <h2>Types &amp; Primitives</h2>
          <h3>Do you even coerce?</h3>
        </section>

        <section>
          <h2>Everything can be considered an Object, except:</h2>
          <ul class="bare">
            <li>null</li>
            <li>undefined</li>
            <li>number (double precision floating point)</li>
            <li>boolean</li>
            <li>string</li>
          </ul>
        </section>

        <section>
          <h2>Primitives vs Objects</h2>
          <ul class="bare">
            <li>Primitives cannot be broken down to an extended type and have no properties of their own (few exceptions like strings).</li>
            <li>Primitives are not passed by reference.</li>
            <li>All the rest are essentially extended Objects (Array, Date, etc.) and are passed by reference.</li>
            <li>Use literal notation where possible, avoid using new keyword on base types</li>
          </ul>
          <pre><code class="language-javascript" data-trim>var foo = 'foo'; // "string" - Good
var foo = String('foo'); // "string" - Bad
var foo = new String('foo'); // "object" - Bad
var foo = (new String('foo')).valueOf(); // "string" - Bad</code></pre>
        </section>

        <section>
          <h2>Cautionary note on typeof</h2>
          <p>It lies!</p>
          <pre><code class="language-javascript" data-trim>typeof null; // "object"
typeof []; // "object"
typeof /regex/; // "function" in some browsers</code></pre>
        </section>

        <section>
          <h2>Dead set on matching the type?</h2>
          <p>
            Abuse the Object.toString method!
          </p>
          <pre><code class="language-javascript" data-trim>Object.prototype.toString.call(null); // "[object Null]"
Object.prototype.toString.call([]); // "[object Array]"
Object.prototype.toString.call(/regex/); // "[object RegExp]"</code></pre>
          <p>(More on prototypes and function methods later!)</p>
          <aside class="notes">
            <p><small>If you need this, you probably have a bigger problem.</small></p>
          </aside>
        </section>

        <section>
          <h2>Cautionary note on numbers</h2>
          <ul>
            <li>Floating point!<br><pre><code class="language-javascript" data-trim>0.2 + 0.2 + 0.2; // 0.6000000000000001 WAT?!</code></pre></li>
            <li>don't care about precision?
              <ul>
                <li>.toFixed() to determine float precision<br><pre><code class="language-javascript">(0.2 + 0.2 + 0.2).toFixed(2); // 0.60</code></pre></li>
                <li>parseInt() with a radix<br><pre><code class="language-javascript">parseInt(42.123456789, 10); // 42</code></pre></li>
              </ul>
            </li>
            <li>Working with currency? Do everything in cents or use a library to provide <a href="https://github.com/MikeMcl/big.js">bigger decimals with arbitraty precision</a></li>
          </ul>
        </section>

        <section>
          <h2>Cautionary note on strings</h2>
          <ul>
            <li>Not as bad as PHP, but still pretty weird sometimes.</li>
            <li><strong>parseInt() if you want to do maths, always provide radix parameter!</strong>
              <pre><code class="language-javascript" data-trim>
parseInt('042'); // Some browsers will default to octal 66.
parseInt('042', 10); // Force parsing as decimal.
parseInt('12foo34', 10); // 12 (!)
              </code></pre>
            </li>
            <li>They can be partially accessed like an array (mainly getters).</li>
          </ul>
          <pre><code class="language-javascript" data-trim>
var foo = 'foo';
foo[0]; // 'f'
foo[0] = 'p'; // Nice try, no setters tho!
foo.split('f').join('p'); // 'poo' (like PHPs explode/implode)
foo.length; // 3
foo.bar = 'baz'; // Nice try, primitives can't have properties tho!
foo.bar; // undefined
          </code></pre>
          <p>This is often referred to as "<em>Array-like</em>" (again, string are actually a bit of an exception here), but should not be considered a fully-fledged array.</p>
        </section>

        <section>
          <h2>Bonus!</h2>
          <pre><code class="language-javascript" data-trim>
var foo = new String('foo');
// Secretly an object wrapper pretending to be a string
foo === 'foo'; // false
foo == 'foo'; // true
foo.lol = 'lol'; // now it actually sticks!
foo.lol; // 'lol'
          </code></pre>
        </section>

        <section>
          <h2>Type coercion</h2>
          <h3>The operator matters!</h3>
          <p>With strings and numbers, the + operator will coerce everything to strings</p>
          <pre><code class="language-javascript" data-trim>
'123' + 4; // '1234'
1 + '234'; // '1234'
          </code></pre>
          <p>Likewise, the - operator will coerce everything to a number</p>
          <pre><code class="language-javascript" data-trim>
'123' - 4; // 119
1 - '234' ; // -233
          </code></pre>
        </section>

        <section>
          <h2>Type coercion</h2>
          <h3>cheap casting!</h3>
          <p>Using the unary + operator, we can easily cast to a number</p>
          <pre><code class="language-javascript" data-trim>
'1.23' + '1.23'; // '1.231.23'
(+'1.23') + (+'1.23'); // 2.46 (parens optional)
          </code></pre>
          <p>This does not save you from <code>NaN</code>ty<code>NaN</code> problems though, always check user input!</p>
        </section>

        <section>
          <h2>Truthy fruity</h2>
          <h3>What !!is and what !is?</h3>
          <p>The following values are considered not "truthy" and will coerce to <code>false</code>:<br><code>undefined</code>, <code>null</code>, <code>NaN</code>, <code>0</code>, <code>''</code></p>
        </section>

        <section>
          <h2>Truthy fruity</h2>
          <h3>Shortcuts</h3>
          <pre><code class="language-javascript" data-trim>
// someInit will not be executed if someVar is falsy
var foo = someVar || someInit();
// Useful for defaults!
var bar = function (x) {
  x = x || myDefaults;
};
          </code></pre>
        </section>

        <section>
          <h2>The mighty Array!</h2>
          <ul>
            <li>Unlike in PHP, array keys can only be numeric, using string keys on an array will cause it to show its underling object-like nature.<pre><code class="language-javascript" data-trim>
var foo = ['poo'];
foo.length; // 1
foo.bar = 'bar';
foo.length; // 1
foo.bar; // 'bar' (foo['bar'] also works)
foo; // ['poo']
            </code></pre></li>
            <li>jQuery's $() query returns an array of results that's augmented with properties and methods.</li>
          </ul>
        </section>

        <section>
          <h2>The mighty Array!</h2>
          <ul>
            <li>Avoid manually assigning keys, missing ones will be undefined. Instead, use Array.push().<pre><code class="language-javascript" data-trim>
var foo = ['lala', 'hihi'];
foo.push('hoho'); // 3 (Array.push returns new length)
foo[7] = 'lolapi';
foo.length; // 8
foo[6]; // undefined
            </code></pre></li>
          </ul>
        </section>

        <section>
          <h2>The mighty Array!</h2>
          <ul>
            <li><strong>Never ever</strong> for...in loop on an array, use a regular for-loop!
              <pre><code class="language-javascript" data-trim>
var foo = ['bar'];
foo.lol = 'gotcha!';
for (var i in foo) {
  console.log(foo[i]); // 'bar', 'gotcha!'
}
for (var i = 0, len = foo.length; i &lt; len; i++) {
  console.log(foo[i]); // 'bar'
}
              </code></pre></li>
          </ul>
        </section>

        <section>
          <h2>The even mightier Object!</h2>
          <ul>
            <li>As mentioned before, the Object object is the basis for most types in JavaScript.</li>
            <li>Avoid extending or overriding its prototype as this will affect nearly everything.</li>
            <li>When looping over an object, use hasOwnProperty to verify it did not come from prototype chain
            <pre><code class="language-javascript">Object.prototype.lol = 'lolapi';
var foo = {'meh': 'poo'};
for (var key in foo) {
  console.log(key); // 'meh', 'lol'
  if (foo.hasOwnProperty(key)) {
    console.log(key); // Just 'meh'
  }
}</code></pre>More on inheritence later!</li>
        </ul>
      </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>Creator of scope</h3>
          <pre><code class="language-javascript" data-trim>
function foo() {
  var bar = 'lol';
}
foo();
console.log(bar); // undefined
          </code></pre>
          <pre><code class="language-javascript" data-trim>
var bar = 'lol';
function foo(bar) {
  return bar;
}
console.log(foo()); // undefined
          </code></pre>
        </section>

        <section>
          <h2>Function: Creator of scope</h2>
          <h3>Immediately Invoked Function Expression</h3>
          <pre><code class="language-javascript" data-trim>
var x = 'bar';

(function (x) {

  x === 'foo'; // true

})('foo');

x === 'bar'; // true

// Roughly equivalent (without accessible leftovers)

var foo = function(x) {}
foo('foo');
          </code></pre>
        </section>

        <section>
          <h2>Function: Creator of scope</h2>
          <h3>Immediately Invoked Function Expression</h3>
          <pre><code class="language-javascript" data-trim>
(function (x, y) {

  x === 'foo'; // true
  y === window; // true if in a browser and not hosed outside scope
  var foo = "I won't leak to the global scope!";
  y.bar = "I will!"; // same as window.bar

})('foo', this);
foo; // undefined
bar; // "I will!"
          </code></pre>
        </section>

        <section>
          <h2>Function: IIFE</h2>
          <h3>Why is this useful?</h3>
          <pre><code class="language-javascript" data-trim>
(function(window){
  var myLittlePrivate = 'foo';
  window.getPrivate = function() {
    return myLittlePrivate;
  };
})(this);
getPrivate(); // 'foo'
myLittlePrivate; // ReferenceError: myLittlePrivate is not defined
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>Can return functions</h3>
          <pre><code class="language-javascript" data-trim>
function multiply (x) {
  return function (y) {
    return x*y;
  }
}
multiply(2)(3); // 6
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>And so much more!</h3>
          <pre><code class="language-javascript" data-trim>
function maths(x) {
  return {
    multiply: function(y) {
      return x * y;
    },
    add: function(y) {
      return x + y;
    },
    abs: Math.abs(x)
  }
}
maths(2).multiply(3); // 6
maths(2).add(3); // 5
maths(-2).abs; // 2
          </code></pre>
        </section>

        <section>
          <h2>The mighties: Function</h2>
          <h3>"this" is madness!</h3>
          <pre><code class="language-javascript" data-trim>
var foo = {
  a: 'lol',
  b: function() {
    return this.a;
  }
};
foo.b(); // 'lol'
var bar = foo.b;
bar(); // undefined
          </code></pre>
          <p>Here, <code>bar</code> is actually <code>window.bar</code>, so the window object becomes the context, and there is no <code>window.a</code>.</p>
        </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>Special methods and magic "this"!</h3>
          <pre><code class="language-javascript" data-trim>
var foo = function() {
  return this;
}

var bar = foo.bind('bar!');

foo(); // returns reference to the window object.
bar(); // 'bar!'
foo.call('lol'/* , arg1, arg2 */); // 'lol'
foo.apply('lol'/* , [arg1, arg2] */); // 'lol'
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>So how do I function?</h3>
          <pre><code class="language-javascript" data-trim>
// Defined at run-time.
foo(); // ReferenceError: foo is not defined

var foo = function () {};
          </code></pre>
          <pre><code class="language-javascript" data-trim>
// Defined at parse-time for this block.
foo(); // no error

function foo() {};
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Function</h2>
          <h3>What is even going on here?</h3>
          <pre><code class="language-javascript" data-trim>
// Essentially an anonymous function stored in a variable.
var foo = function () { };

foo.name; // '' (empty string)
          </code></pre>
          <pre><code class="language-javascript" data-trim>
// A named function.
function foo() { };

foo.name; // 'foo'
          </code></pre>
          <pre><code class="language-javascript" data-trim>
// But wait!
var foo = function bar() { };

foo.name; // 'bar'
bar.name; // ReferenceError: bar is not defined
// WAT?!
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Bonus points!</h3>
          <pre><code class="language-javascript" data-trim>
// We can return ourselves!
var foo = function bar() {
  // Do some things...

  return bar;
};

foo.name; // 'bar'
foo().name; // 'bar'
foo()()()()()()()(); // ...
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Callbacks &amp; setTimeout/setInterval</h3>
          <pre><code class="language-javascript" data-trim>
// Logs 'HOLLABACK!' every second.
var foo = function() {
  console.log('HOLLABACK!');
  window.setTimeout(foo, 1000);
};
window.setTimeout(foo, 1000);
// Bad:
var foo = function() {
  console.log('What if I took more than 1 second to run?');
};
window.setInterval(foo, 1000);
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Why is this even useful?</h3>
          <pre><code class="language-javascript" data-trim>
// Remember, we're also an object.
var foo = function bar(op) {
  // Do some things...
  bar.doStuff = function() {
    // Do stuff
    return bar;
  };
  bar.doMoreStuff = function() {
    // Do more stuff
    return bar;
  };
  if (op &amp;&amp; bar[op]) { // if an op was passed and it exists
    return bar[op](); // call it and return the return
  }
  return bar; // Return ourselves
};
foo().doStuff().doMoreStuff(); // or foo('doStuff')('doMoreStuff')...
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>But wait!</h3>
          <pre><code class="language-javascript" data-trim>
// Same as before.
var foo = function bar() {
  bar.doStuff = function() { return bar; };
  return bar;
};
// But now we call the method directly on the object
// instead of executing it first.
foo.doStuff(); // TypeError: undefined is not a function
foo(); // We get the same object function, but now it has methods.
foo.doStuff(); // The same global reference now works!
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>So how do I instance?</h3>
          <pre><code class="language-javascript" data-trim>
// Define it as a constructor.
function Foo() { // capital is just convention
  this.bar = function() { return this; };
};
var one = new Foo(); // Note the "new"
var two = new Foo();
one === two; // false, they are 2 separate instances
one.bar() === two.bar(); // false
one.bar() === one; // true
one instanceof Foo; // true
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Inheritance</h3>
          <pre><code class="language-javascript" data-trim>
var Foo = function() {
  this.bar = 0;
};
// Define its base object.
Foo.prototype = {
  addBar: function() { this.bar++; }
};
var foo = new Foo(); // foo > Foo.prototype > Object.prototype > null
foo.addBar();
foo.bar; // 1
Object.getPrototypeOf(foo).bar; // undefined
Foo.prototype.meh = 'lol';
foo.meh; // 'lol'
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Inheritance</h3>
          <pre><code class="language-javascript" data-trim>
var Foo = function() {
  this.bar = 0;
  this.addBar = function() { this.bar++; return this.bar; };
};
var Bar = function() {
  this.addBar = function(i) { this.bar = this.bar + i; return this.bar; };
};
Bar.prototype = new Foo(); // Set Bar's prototype to new instance of Foo
var foo = new Foo(); // Foo.prototype is essentially an empty object
var bar = new Bar(); // bar > Bar.prototype (Foo) > Foo.prototype ({}) > Object.prototype > null
bar.addBar(7); // 7
foo.addBar(7); // 1
bar.bar; // 7
Bar.prototype.meh = 'lol';
bar.meh; // 'lol'
foo.meh; // undefined
          </code></pre>
        </section>

        <section>
          <h2>The mightiest: Functions</h2>
          <h3>Inheritance</h3>
          <pre><code class="language-javascript" data-trim>
var Foo = function() {
  this.bar = 0;
  this.addBar = function() { this.bar++; return this.bar; };
};
var Bar = function() {
  this.addBar = function(i) { this.bar = this.bar + i; return this.bar; };
  this.callSuper = function(op, arg) {
    return Object.getPrototypeOf(this)[op].call(this, arg);
  };
}
Bar.prototype = new Foo();
var foo = new Foo();
var bar = new Bar();
bar.callSuper('addBar', 7); // 1
          </code></pre>
        </section>

        <section>
          <h2>Who wants constructors anyway?</h2>
          <h3>Keeping things light</h3>
          <pre><code class="language-javascript" data-trim>
function create(parent) { // aka "justMakeMeAChildAlready"
  var Constructor = function () {}; // Empty constructor function
  Constructor.prototype = parent; // Attach prototype object
  // Return new instance, inheriting from parent
  return new Constructor();
}
var a = { foo: 'lol' };
var b = create(a);
b.foo; // 'lol'
a.bar = 'baz';
b.bar; // 'baz'
b.meh = 'nope';
a.meh; // undefined
          </code></pre>
        </section>

        <section>
          <section>
            <h2>Enter: Object.create</h2>
            <h3>Syntax</h3>
            <pre><code class="language-javascript" data-trim>
  Object.create(proto /*[, props ]*/)
            </code></pre>
            <h3>Summary</h3>
            <p>The <strong>Object.create()</strong> method creates a new object with the specified prototype object and properties.</p>
            <h4>Arguments</h4>
            <p><em>proto</em>: The object which should be the prototype of the newly-created object.</p>
            <p><em>props</em>: An object whose enumerable own properties specify property descriptors to be added to the newly-created object, with the corresponding property names.</p>
          </section>
          <section>
            <h2>Enter: Object.create</h2>
            <h3>Polyfill (IE<9)</h3>
            <pre><code class="language-javascript" data-trim>
if (typeof Object.create != 'function') {
    (function () {
        var F = function () {};
        Object.create = function (o) {
            if (arguments.length > 1) { throw Error('Second argument not supported');}
            if (o === null) { throw Error('Cannot set a null [[Prototype]]');}
            if (typeof o != 'object') { throw TypeError('Argument must be an object');}
            F.prototype = o;
            return new F();
        };
    })();
}
            </code></pre>
          </section>
        </section>

        <section>
          <h2>In the wild!</h2>
          <h3>From BackBone source:</h3>
          <pre><code class="language-javascript" data-trim>
var extend = function(protoProps, staticProps) {
  var parent = this;
  var child;
  if (protoProps &amp;&amp; _.has(protoProps, 'constructor')) {
    child = protoProps.constructor;
  } else {
    child = function(){ return parent.apply(this, arguments); };
  }
  _.extend(child, parent, staticProps);
  var Surrogate = function(){ this.constructor = child; };
  Surrogate.prototype = parent.prototype;
  child.prototype = new Surrogate;
  if (protoProps) _.extend(child.prototype, protoProps);
  child.__super__ = parent.prototype;
  return child;
};
          </code></pre>
        </section>

        <section>
          <h2>The DOM</h2>
          <h3>Object with god-complexes</h3>
          <ul>
            <li>Object-tree representation of entire document</li>
            <li>Contains and exposes most of the APIs we use</li>
            <li>Used to be really, really, really annoying, now just really really</li>
            <li>Traversing this mess is the main purpose of libraries like jQuery</li>
            <li>Manipulations (and some getters, even) are costly and should be kept to a minimum.</li>
          </ul>
        </section>

        <section>
          <h2>Traversal</h2>
          <h3>All the nesting!</h3>
          <pre><code class="language-javascript" data-trim>
// [ &lt;html element> ]
document.children;

// [ &lt;head element>, &lt;body element> ]
document.children[0].children;

// [ &lt;element with class someClass>, &lt;...> ]
document.getElementsByClassName('someClass');

// equivalent
document.querySelectorAll('.someClass');
          </code></pre>

        </section>

        <section>
          <h2>Caution!</h2>
          <h3>Document ready</h3>
          <p>Remember: You cannot query for an element if it hasn't been parsed yet. Place scripts at the bottom or use things like jQuery's <code>$(document).ready(function() { ... })</code></p>
          <pre><code class="language-html" data-trim>
&lt;html>
  &lt;head>
    &lt;script>
      //TypeError: Cannot read property 'querySelector' of null
      var foo = document.body.querySelector('.foo');
    &lt;/script>
  &lt;/head>
  &lt;body>
    &lt;div class="foo">foo&lt;/div>
    &lt;script>
      // Works fine
      var foo = document.body.querySelector('.foo');
    &lt;/script>
  &lt;/body>
&lt;/html>
          </code></pre>

        </section>

        <section>
          <h2>Caution!</h2>
          <p>As mentioned before, array-like does not mean it's an array.</p>
          <pre><code class="language-javascript" data-trim>
var foo = document.querySelectorAll('.foo');
foo.forEach; // undefined - does not have array method.
// Invoke array method in the context of our collection.
Array.prototype.forEach.call(foo, function(el) { // Pass in anonymous function
  console.log(el); // logs out each element separately.
});
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3><a href="/events.html" target="_blank">Bubbles!</a></h3>
          <pre><code class="language-javascript" data-trim>
  // Define a handler for our events.
  var handler = function(event) { console.log(this, event.target); },
      body = window.document.body, // Cache some element references.
      form = body.querySelector('form'),
      button = form.querySelector('input[type="button"]');
  // Add our event listener to the cached references.
  body.addEventListener('click', handler);
  form.addEventListener('click', handler);
  button.addEventListener('click', handler);
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3><a href="/stopPropagation.html" target="_blank">Event methods: stopPropagation!</a></h3>
          <pre><code class="language-javascript" data-trim>
  // Handler that calls stopPropagation on the event.
  var handler = function(event) {
        console.log(this, event.target);
        event.stopPropagation();
      },
      body = window.document.body, // Cache some element references.
      form = body.querySelector('form'),
      button = form.querySelector('input[type="submit"]');
  // Add our event listener to the cached references.
  body.addEventListener('click', handler);
  form.addEventListener('click', handler);
  button.addEventListener('click', handler);
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3><a href="/preventDefault.html" target="_blank">Event methods: preventDefault!</a></h3>
          <pre><code class="language-javascript" data-trim>
  // Handler that calls preventDefault on the event.
  var handler = function(event) {
        event.preventDefault();
      },
      form = window.document.body.querySelector('form');
  // The handler will effectively prevent
  // the native submit event from happening.
  form.addEventListener('submit', handler);
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3><a href="/delegating.html" target="_blank">Advanced techniques: Delegating!</a></h3>
          <pre><code class="language-javascript" data-trim>
(function(window) {
  var handler = function(e) {
        // Only act if the actual target is '.foo'
        if (e.target.className = 'foo') {
          event.preventDefault();
          console.log('Do something!');
        }
      };
  // Attach the handler to the entire body element.
  window.document.body.addEventListener('click', handler);
})(this);
          </code></pre>
          <p>Like jQuery's <code>$.fn.on()</code>, <code>$.fn.delegate</code>, ...</p>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3>All the async!</h3>
          <pre><code class="language-javascript" data-trim>
// Bad:
var data = $.get('some/url', function(data) {
  return data;
});
console.log(data); // XMLHttpRequest object o.O
// Instead:
$.get('some/url', function(data) {
  console.log(data);
});
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3>But what if I need it?</h3>
          <pre><code class="language-javascript" data-trim>
(function($) {
  // initialize returnData in this scope
  var returnData,
      // Example function to shout out the data
      shoutOut = function() {
        if (data) {
          console.log(data);
        }
      };
  // Grab the data, assign the variable and call the function.
  $.get('some/url', function(data) {
    returnData = data;
    shoutOut();
  });
})(jQuery)
          </code></pre>
        </section>

        <section>
          <h2>The driver of it all: Events</h2>
          <h3>What is actually going on?</h3>
          <pre><code class="language-javascript" data-trim>
var callback = function() { /* do something*/ };
$.get('some/url', callback);
          </code></pre>
          <p>What goes on internally:</p>
          <ul>
            <li>Reference to callback function is stored.</li>
            <li>XMLHttpRequest is made and stored for reference.</li>
            <li>Time passes, interpreter continues to interpret.</li>
            <li>If successfull -> callback.apply(XMLHttpRequest, [ data, textStatus, XMLHttpRequest])</li>
            <li>When $.get is called, it immediately returns the XMLHttpRequest object.</li>
          </ul>
        </section>

        <section>
          <section>
            <h2>Bonus!</h2>
            <h3>Monkey-patching/duck-punching</h3>
            <pre><code class="language-javascript" data-trim>
  // Probably the most annoying piece of JS in Drupal 7
  Drupal.jsAC.prototype.hidePopup = function(keycode) {
      /* hidden some irrelevant stuff */
      // Hide popup.
      var popup = this.popup;
      if (popup) {
          this.popup = null;
          $(popup).fadeOut('fast', function() {
              $(popup).remove(); // &lt;- doesn't hide, but actually removes!
          });
      }
      this.selected = false;
      $(this.ariaLive).empty();
  };
            </code></pre>
          </section>

          <section>
            <h2>Bonus!</h2>
            <h3>Monkey-patching/duck-punching</h3>
            <pre><code class="language-javascript" data-trim>
// Remember, a function is just a variable holding a reference
// We can just change the reference to point to something else
Drupal.jsAC.prototype.hidePopup = function() { /* do nothing */ }
// Now it won't disappear and we can theme it!
            </code></pre>
          </section>
        </section>

          <section>
            <h2>Bonus!</h2>
            <h3>Monkey-patching/duck-punching</h3>
            <pre><code class="language-javascript" data-trim>
// But what if we still wanna use the original?
(function(window){
  // Scope a reference!
  var _alert = window.alert;
  window.alert = function (arg) {
    // Do some extra stuff
    console.log('Alert called!', arg);
    // Call the original function with proper arguments and "this" context
    _alert.call(this, arg);
  }
})(this)
            </code></pre>
          </section>
        </section>

        <!-- Example of nested vertical slides -->
        <section>
          <section>
            <h2>Vertical Slides</h2>
            <p>
              Slides can be nested inside of other slides,
              try pressing <a href="#" class="navigate-down">down</a>.
            </p>
            <a href="#" class="image navigate-down">
              <img width="178" height="238" src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png" alt="Down arrow">
            </a>
          </section>
          <section>
            <h2>Basement Level 1</h2>
            <p>Press down or up to navigate.</p>
          </section>
          <section>
            <h2>Basement Level 2</h2>
            <p>Cornify</p>
            <a class="test" href="http://cornify.com">
              <img width="280" height="326" src="https://s3.amazonaws.com/hakim-static/reveal-js/cornify.gif" alt="Unicorn">
            </a>
          </section>
          <section>
            <h2>Basement Level 3</h2>
            <p>That's it, time to go back up.</p>
            <a href="#/2" class="image">
              <img width="178" height="238" src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png" alt="Up arrow" style="-webkit-transform: rotate(180deg);">
            </a>
          </section>
        </section>

        <section>
          <h2>Slides</h2>
          <p>
            Not a coder? No problem. There's a fully-featured visual editor for authoring these, try it out at <a href="http://slid.es" target="_blank">http://slid.es</a>.
          </p>
        </section>

        <section>
          <h2>Point of View</h2>
          <p>
            Press <strong>ESC</strong> to enter the slide overview.
          </p>
          <p>
            Hold down alt and click on any element to zoom in on it using <a href="http://lab.hakim.se/zoom-js">zoom.js</a>. Alt + click anywhere to zoom back out.
          </p>
        </section>

        <section>
          <h2>Works in Mobile Safari</h2>
          <p>
            Try it out! You can swipe through the slides and pinch your way to the overview.
          </p>
        </section>

        <section>
          <h2>Marvelous Unordered List</h2>
          <ul>
            <li>No order here</li>
            <li>Or here</li>
            <li>Or here</li>
            <li>Or here</li>
          </ul>
        </section>

        <section>
          <h2>Fantastic Ordered List</h2>
          <ol>
            <li>One is smaller than...</li>
            <li>Two is smaller than...</li>
            <li>Three!</li>
          </ol>
        </section>

        <section data-markdown>
          <script type="text/template">
            ## Markdown support

            For those of you who like that sort of thing. Instructions and a bit more info available [here](https://github.com/hakimel/reveal.js#markdown).

            ```
            <section data-markdown>
              ## Markdown support

              For those of you who like that sort of thing.
              Instructions and a bit more info available [here](https://github.com/hakimel/reveal.js#markdown).
            </section>
            ```
          </script>
        </section>

        <section id="transitions">
          <h2>Transition Styles</h2>
          <p>
            You can select from different transitions, like: <br>
            <a href="?transition=cube#/transitions">Cube</a> -
            <a href="?transition=page#/transitions">Page</a> -
            <a href="?transition=concave#/transitions">Concave</a> -
            <a href="?transition=zoom#/transitions">Zoom</a> -
            <a href="?transition=linear#/transitions">Linear</a> -
            <a href="?transition=fade#/transitions">Fade</a> -
            <a href="?transition=none#/transitions">None</a> -
            <a href="?#/transitions">Default</a>
          </p>
        </section>

        <section id="themes">
          <h2>Themes</h2>
          <p>
            Reveal.js comes with a few themes built in: <br>
            <a href="?#/themes">Default</a> -
            <a href="?theme=sky#/themes">Sky</a> -
            <a href="?theme=beige#/themes">Beige</a> -
            <a href="?theme=simple#/themes">Simple</a> -
            <a href="?theme=serif#/themes">Serif</a> -
            <a href="?theme=night#/themes">Night</a> <br>
            <a href="?theme=moon#/themes">Moon</a> -
            <a href="?theme=solarized#/themes">Solarized</a>
          </p>
          <p>
            <small>
              * Theme demos are loaded after the presentation which leads to flicker. In production you should load your theme in the <code class="language-javascript">&lt;head&gt;</code> using a <code class="language-javascript">&lt;link&gt;</code>.
            </small>
          </p>
        </section>

        <section>
          <h2>Global State</h2>
          <p>
            Set <code class="language-javascript">data-state="something"</code> on a slide and <code class="language-javascript">"something"</code>
            will be added as a class to the document element when the slide is open. This lets you
            apply broader style changes, like switching the background.
          </p>
        </section>

        <section data-state="customevent">
          <h2>Custom Events</h2>
          <p>
            Additionally custom events can be triggered on a per slide basis by binding to the <code class="language-javascript">data-state</code> name.
          </p>
          <pre><code class="language-javascript" data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
Reveal.addEventListener( 'customevent', function() {
  console.log( '"customevent" has fired' );
} );
          </code></pre>
        </section>

        <section>
          <section data-background="#007777">
            <h2>Slide Backgrounds</h2>
            <p>
              Set <code class="language-javascript">data-background="#007777"</code> on a slide to change the full page background to the given color. All CSS color formats are supported.
            </p>
            <a href="#" class="image navigate-down">
              <img width="178" height="238" src="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png" alt="Down arrow">
            </a>
          </section>
          <section data-background="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png">
            <h2>Image Backgrounds</h2>
            <pre><code class="language-javascript">&lt;section data-background="image.png"&gt;</code></pre>
          </section>
          <section data-background="https://s3.amazonaws.com/hakim-static/reveal-js/arrow.png" data-background-repeat="repeat" data-background-size="100px">
            <h2>Repeated Image Backgrounds</h2>
            <pre><code class="language-javascript" style="word-wrap: break-word;">&lt;section data-background="image.png" data-background-repeat="repeat" data-background-size="100px"&gt;</code></pre>
          </section>
        </section>

        <section data-transition="linear" data-background="#4d7e65" data-background-transition="slide">
          <h2>Background Transitions</h2>
          <p>
            Pass reveal.js the <code class="language-javascript">backgroundTransition: 'slide'</code> config argument to make backgrounds slide rather than fade.
          </p>
        </section>

        <section data-transition="linear" data-background="#8c4738" data-background-transition="slide">
          <h2>Background Transition Override</h2>
          <p>
            You can override background transitions per slide by using <code class="language-javascript">data-background-transition="slide"</code>.
          </p>
        </section>

        <section>
          <h2>Clever Quotes</h2>
          <p>
            These guys come in two forms, inline: <q cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
            &ldquo;The nice thing about standards is that there are so many to choose from&rdquo;</q> and block:
          </p>
          <blockquote cite="http://searchservervirtualization.techtarget.com/definition/Our-Favorite-Technology-Quotations">
            &ldquo;For years there has been a theory that millions of monkeys typing at random on millions of typewriters would
            reproduce the entire works of Shakespeare. The Internet has proven this theory to be untrue.&rdquo;
          </blockquote>
        </section>

        <section>
          <h2>Pretty Code</h2>
          <pre><code class="language-javascript" data-trim contenteditable>
function linkify( selector ) {
  if( supports3DTransforms ) {

    var nodes = document.querySelectorAll( selector );

    for( var i = 0, len = nodes.length; i &lt; len; i++ ) {
      var node = nodes[i];

      if( !node.className ) {
        node.className += ' roll';
      }
    }
  }
}
          </code></pre>
          <p>Courtesy of <a href="http://softwaremaniacs.org/soft/highlight/en/description/">highlight.js</a>.</p>
        </section>

        <section>
          <h2>Intergalactic Interconnections</h2>
          <p>
            You can link between slides internally,
            <a href="#/2/3">like this</a>.
          </p>
        </section>

        <section>
          <section id="fragments">
            <h2>Fragmented Views</h2>
            <p>Hit the next arrow...</p>
            <p class="fragment">... to step through ...</p>
            <ol>
              <li class="fragment"><code class="language-javascript">any type</code></li>
              <li class="fragment"><em>of view</em></li>
              <li class="fragment"><strong>fragments</strong></li>
            </ol>

            <aside class="notes">
              This slide has fragments which are also stepped through in the notes window.
            </aside>
          </section>
          <section>
            <h2>Fragment Styles</h2>
            <p>There's a few styles of fragments, like:</p>
            <p class="fragment grow">grow</p>
            <p class="fragment shrink">shrink</p>
            <p class="fragment roll-in">roll-in</p>
            <p class="fragment fade-out">fade-out</p>
            <p class="fragment highlight-red">highlight-red</p>
            <p class="fragment highlight-green">highlight-green</p>
            <p class="fragment highlight-blue">highlight-blue</p>
            <p class="fragment current-visible">current-visible</p>
            <p class="fragment highlight-current-blue">highlight-current-blue</p>
          </section>
        </section>

        <section>
          <h2>Spectacular image!</h2>
          <a class="image" href="http://lab.hakim.se/meny/" target="_blank">
            <img width="320" height="299" src="http://s3.amazonaws.com/hakim-static/portfolio/images/meny.png" alt="Meny">
          </a>
        </section>

        <section>
          <h2>Export to PDF</h2>
          <p>Presentations can be <a href="https://github.com/hakimel/reveal.js#pdf-export">exported to PDF</a>, below is an example that's been uploaded to SlideShare.</p>
          <iframe id="slideshare" src="http://www.slideshare.net/slideshow/embed_code/13872948" width="455" height="356" style="margin:0;overflow:hidden;border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen> </iframe>
          <script>
            document.getElementById('slideshare').attributeName = 'allowfullscreen';
          </script>
        </section>

        <section>
          <h2>Take a Moment</h2>
          <p>
            Press b or period on your keyboard to enter the 'paused' mode. This mode is helpful when you want to take distracting slides off the screen
            during a presentation.
          </p>
        </section>

        <section>
          <h2>Stellar Links</h2>
          <ul>
            <li><a href="http://slid.es">Try the online editor</a></li>
            <li><a href="https://github.com/hakimel/reveal.js">Source code on GitHub</a></li>
            <li><a href="http://twitter.com/hakimel">Follow me on Twitter</a></li>
          </ul>
        </section>

        <section>
          <h1>THE END</h1>
          <h3>BY Hakim El Hattab / hakim.se</h3>
        </section>

      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        //theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        theme: 'simple',
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
